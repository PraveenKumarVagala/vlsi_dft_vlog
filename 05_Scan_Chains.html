<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scan Chains | DFT Blog</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1><a href="index.html">ğŸ”§ DFT Blog</a></h1>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="04_Introduction_to_DFT.html">â† Prev</a>
                <a href="06_ATPG_Basics.html">Next â†’</a>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="article-header">
            <span class="article-number">Part 5 of 11</span>
            <h1>Scan Chains</h1>
            <p class="subtitle">The backbone of structural testing</p>
            <p class="author">By <strong>Praveen Kumar Vagala</strong></p>
        </div>

        <h2>What is Scan?</h2>
        <p>Scan connects all flip-flops into a long shift register, allowing direct access to internal state.</p>

        <h3>Normal Mode (Functional Operation)</h3>
<div class="diagram">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DFF1  â”‚â”€â”€â”€â”€â–ºâ”‚  DFF2  â”‚â”€â”€â”€â”€â–ºâ”‚  DFF3  â”‚
â”‚ D    Q â”‚     â”‚ D    Q â”‚     â”‚ D    Q â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†‘              â†‘              â†‘
   Logic          Logic          Logic
   
Each FF receives data from combinational logic.</div>

        <h3>Scan Mode (Test Operation)</h3>
<div class="diagram">                SI (Scan In)
                   â”‚
                   â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  SFF1  â”‚â”€â”€â”€â”€â–ºâ”‚  SFF2  â”‚â”€â”€â”€â”€â–ºâ”‚  SFF3  â”‚â”€â”€â”€â–º SO
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              
All FFs form a shift register - can load/unload any pattern!</div>

        <h2>Scan Flip-Flop Structure</h2>
        <p>A scan FF is a regular FF with a MUX added at the input:</p>

<div class="diagram">                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     D (func) â”€â”€â”€â”€â”€â–ºâ”‚         â”‚
                    â”‚   MUX   â”‚â”€â”€â”€â–º D â”€â”€â–º FF â”€â”€â”€â–º Q
    SI (scan) â”€â”€â”€â”€â”€â–ºâ”‚         â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                         â”‚
                        SE (scan enable)
                        
SE=0: Normal operation (D â†’ FF â†’ Q)
SE=1: Scan operation (SI â†’ FF â†’ Q)</div>

        <h3>Verilog Implementation</h3>
<pre><code>module scan_dff (
    input      clk,
    input      rst_n,
    input      d,           // Functional data
    input      si,          // Scan input
    input      se,          // Scan enable
    output reg q
);
    wire mux_out;
    
    // Scan MUX: SE selects between functional and scan data
    assign mux_out = se ? si : d;
    
    always @(posedge clk or negedge rst_n) begin
        if (!rst_n)
            q <= 1'b0;
        else
            q <= mux_out;
    end
endmodule</code></pre>

        <h2>Scan Test Operation</h2>

        <h3>Step 1: Shift In (Load Pattern)</h3>
<div class="diagram">SE = 1 (Scan mode)
Apply N clock cycles to shift in test pattern

   SI â”€â”€â–º [0] â”€â”€â–º [1] â”€â”€â–º [0] â”€â”€â–º [1] â”€â”€â–º [1] â”€â”€â–º SO
   
After 5 clocks, pattern "01011" is loaded into 5 FFs.</div>

        <h3>Step 2: Capture (Apply Test)</h3>
<div class="diagram">SE = 0 (Functional mode)
Apply ONE clock cycle

   [0]â”€â”€â–ºLogicâ”€â”€â–º[?]    [1]â”€â”€â–ºLogicâ”€â”€â–º[?]    ...
   
Combinational logic evaluates, results captured in FFs.</div>

        <h3>Step 3: Shift Out (Unload Response)</h3>
<div class="diagram">SE = 1 (Scan mode)
Apply N clock cycles to shift out captured response
(While shifting in next pattern - pipelined!)

   SI â”€â”€â–º [new] â”€â”€â–º [new] â”€â”€â–º [captured] â”€â”€â–º [captured] â”€â”€â–º SO</div>

        <h3>Complete Timing</h3>
<div class="diagram">        â”‚â†â”€â”€ Shift In â”€â”€â†’â”‚Capâ”‚â†â”€â”€ Shift Out â”€â”€â†’â”‚
        
CLK  â”€â”€â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”€

SE   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                         â”—â”â”â”â”›
                         
SI   â”€â”€â”€Pattern Nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Pattern N+1â”€â”€â”€

SO   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€Response Nâ”€â”€â”€â”€â”€</div>

        <h2>Scan Chain Architecture</h2>
        <p>Real chips have multiple scan chains running in parallel:</p>

<div class="diagram">        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                     â”‚
SI[0]â”€â”€â–ºâ”‚  Chain 0: [FF]â”€[FF]â”€[FF]â”€[FF]â”€[FF] â”‚â”€â”€â–ºSO[0]
        â”‚                                     â”‚
SI[1]â”€â”€â–ºâ”‚  Chain 1: [FF]â”€[FF]â”€[FF]â”€[FF]â”€[FF] â”‚â”€â”€â–ºSO[1]
        â”‚                                     â”‚
SI[2]â”€â”€â–ºâ”‚  Chain 2: [FF]â”€[FF]â”€[FF]â”€[FF]â”€[FF] â”‚â”€â”€â–ºSO[2]
        â”‚                                     â”‚
SI[3]â”€â”€â–ºâ”‚  Chain 3: [FF]â”€[FF]â”€[FF]â”€[FF]â”€[FF] â”‚â”€â”€â–ºSO[3]
        â”‚                                     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

More chains = shorter chains = faster shift!</div>

        <h3>Trade-offs</h3>
        <table>
            <tr><th>More Chains</th><th>Fewer Chains</th></tr>
            <tr><td>Faster shift time</td><td>Slower shift time</td></tr>
            <tr><td>More pins needed</td><td>Fewer pins needed</td></tr>
            <tr><td>More routing complexity</td><td>Less routing</td></tr>
        </table>

        <h2>Scan DRC Rules</h2>
        <p><strong>Design Rule Checks that MUST pass:</strong></p>

        <h3>1. All FFs Must Be Scannable</h3>
        <p>Every flip-flop should be in a scan chain (unless specifically excluded).</p>

        <h3>2. Clocks Must Be Controllable</h3>
<div class="diagram">âœ“ GOOD: Clock from controllable source
        CLK_PIN â”€â”€â–º FF

âœ— BAD: Clock from internal logic (uncontrollable)
        Logic â”€â”€â–º FF (clock can't be controlled in scan mode)</div>

        <h3>3. Async Resets Must Be Inactive</h3>
<pre><code>During scan shift:
  RST_N = 1 (inactive)
  
If RST_N = 0, all FFs reset - destroys scan data!</code></pre>

        <h3>4. No Tri-State in Scan Path</h3>
<div class="diagram">âœ— BAD: Tri-state buffer in scan chain
        SI â”€â”€â–º [TRISTATE] â”€â”€â–º FF
        
High-Z would break the chain!</div>

        <h3>5. No Combinational Loops</h3>
<div class="diagram">âœ— BAD: Feedback without FF
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚
        â–¼                â”‚
      Logic â”€â”€â–ºâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”˜
      
Can't determine stable value!</div>

        <div class="summary">
            <h3>Summary</h3>
            <table>
                <tr><th>Concept</th><th>Key Point</th></tr>
                <tr><td>Scan FF</td><td>Regular FF + MUX for scan input</td></tr>
                <tr><td>SE=0</td><td>Functional mode (normal operation)</td></tr>
                <tr><td>SE=1</td><td>Scan mode (shift register)</td></tr>
                <tr><td>Shift In</td><td>Load test pattern into all FFs</td></tr>
                <tr><td>Capture</td><td>One functional clock, capture response</td></tr>
                <tr><td>Shift Out</td><td>Unload response from all FFs</td></tr>
            </table>
        </div>

        <div class="nav-buttons">
            <a href="04_Introduction_to_DFT.html" class="nav-btn prev">Introduction to DFT</a>
            <a href="06_ATPG_Basics.html" class="nav-btn next">ATPG Basics</a>
        </div>
    </div>
    
    <div class="footer">
        <p>DFT Engineering Blog Series | Part 5 of 11</p>
    </div>
</body>
</html>

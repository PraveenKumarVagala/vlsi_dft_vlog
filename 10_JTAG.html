<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JTAG | DFT Blog</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1><a href="index.html">ğŸ”§ DFT Blog</a></h1>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="09_BIST.html">â† Prev</a>
                <a href="11_Practical_DFT_Flow.html">Next â†’</a>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="article-header">
            <span class="article-number">Part 10 of 11</span>
            <h1>JTAG (IEEE 1149.1)</h1>
            <p class="subtitle">The universal debug and test interface</p>
            <p class="author">By <strong>Praveen Kumar Vagala</strong></p>
        </div>

        <h2>What is JTAG?</h2>
        <p><strong>JTAG = Joint Test Action Group</strong></p>
        <p>A standard 5-wire interface for testing and debugging chips. Found on nearly every modern chip.</p>

<div class="diagram">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                         â”‚
â”‚   TDI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚  (Test Data In)                         â”‚
â”‚                                         â”‚
â”‚   TDO â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚  (Test Data Out)                        â”‚
â”‚                                         â”‚
â”‚   TCK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚  (Test Clock)                           â”‚
â”‚                                         â”‚
â”‚   TMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚  (Test Mode Select)                     â”‚
â”‚                                         â”‚
â”‚   TRST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
â”‚  (Test Reset - optional)                â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</div>

        <h2>The 5 JTAG Signals</h2>
        <table>
            <tr><th>Signal</th><th>Direction</th><th>Purpose</th></tr>
            <tr><td><strong>TDI</strong></td><td>Input</td><td>Serial data into chip</td></tr>
            <tr><td><strong>TDO</strong></td><td>Output</td><td>Serial data out of chip</td></tr>
            <tr><td><strong>TCK</strong></td><td>Input</td><td>Test clock</td></tr>
            <tr><td><strong>TMS</strong></td><td>Input</td><td>Controls TAP state machine</td></tr>
            <tr><td><strong>TRST</strong></td><td>Input</td><td>Async reset (optional)</td></tr>
        </table>

        <p><strong>Key insight:</strong> Only 5 pins to access the entire chip!</p>

        <h2>TAP Controller</h2>
        <p><strong>TAP = Test Access Port</strong></p>
        <p>A state machine that controls JTAG operations.</p>

<div class="diagram">                             TMS=1 (stay in reset)
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚             â”‚
                        â–¼             â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â–ºâ”‚Test-Logicâ”‚â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚       â”‚  Reset   â”‚
          â”‚       â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚            â”‚ TMS=0
          â”‚            â–¼
          â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   â”Œâ”€â”€â”€â”‚Run-Test/ â”‚â—„â”€â”€â”
          â”‚   â”‚   â”‚   Idle   â”‚   â”‚ TMS=0
          â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜â”€â”€â”€â”˜
          â”‚   â”‚        â”‚ TMS=1
          â”‚   â”‚        â–¼
          â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   â”‚   â”‚Select-DR â”‚â”€â”€TMS=1â”€â–ºâ”‚Select-IR â”‚
          â”‚   â”‚   â”‚  Scan    â”‚         â”‚  Scan    â”‚
          â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚   â”‚        â”‚ TMS=0              â”‚ TMS=0
          â”‚   â”‚        â–¼                    â–¼
          â”‚   â”‚      (DR Path)           (IR Path)
          â”‚   â”‚         â”‚                   â”‚
          â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    (from Update-DR/IR)</div>

        <h3>Main Paths</h3>
        <ul>
            <li><strong>DR Path:</strong> Access Data Registers (scan chains, bypass, ID)</li>
            <li><strong>IR Path:</strong> Load Instructions (tell TAP what to do)</li>
        </ul>

        <h2>JTAG Instructions</h2>
        <p>Common instructions loaded via IR path:</p>

        <table>
            <tr><th>Instruction</th><th>Opcode</th><th>Purpose</th></tr>
            <tr><td><strong>BYPASS</strong></td><td>All 1s</td><td>Pass data through (1-bit register)</td></tr>
            <tr><td><strong>EXTEST</strong></td><td>Varies</td><td>Test external connections</td></tr>
            <tr><td><strong>SAMPLE</strong></td><td>Varies</td><td>Sample I/O pins</td></tr>
            <tr><td><strong>INTEST</strong></td><td>Varies</td><td>Test internal logic</td></tr>
            <tr><td><strong>IDCODE</strong></td><td>Varies</td><td>Read chip ID</td></tr>
            <tr><td><strong>USERCODE</strong></td><td>Varies</td><td>User-defined code</td></tr>
        </table>

        <h2>JTAG Scan Operations</h2>

        <h3>1. Load Instruction</h3>
<pre><code>1. Go to Shift-IR state
2. Shift instruction into IR
3. Go to Update-IR
4. Instruction takes effect</code></pre>

        <h3>2. Shift Data</h3>
<pre><code>1. Go to Shift-DR state
2. Shift data in/out through selected register
3. Go to Update-DR
4. New data takes effect</code></pre>

        <h2>Boundary Scan</h2>
        <p>JTAG's original purpose: test connections between chips on a board.</p>

<div class="diagram">        Chip A                      Chip B
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    â—‹â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â—‹    â”‚
    â”‚    â—‹â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â—‹    â”‚
    â”‚    â—‹â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚â”€â”€â”€â”€â”€â—‹    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†‘                            â†‘
    Boundary                    Boundary
    Scan Cells                  Scan Cells</div>

        <h3>Boundary Scan Cell</h3>
<div class="diagram">                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
From Core â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚â”€â”€â”€â”€â”€â”€â–º To Pin
                 â”‚   Boundary Cell     â”‚
From Pin  â”€â”€â”€â”€â”€â”€â–ºâ”‚                     â”‚â”€â”€â”€â”€â”€â”€â–º To Core  
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               Shift     Update      Mode
               (TDI/TDO)  Reg       Control</div>

        <p>Each I/O pin has a boundary scan cell that can:</p>
        <ul>
            <li>Capture pin value (sample)</li>
            <li>Drive pin value (force)</li>
            <li>Pass through normally (transparent)</li>
        </ul>

        <h2>Daisy Chaining</h2>
        <p>Multiple chips share one JTAG interface:</p>

<div class="diagram">TDI â”€â”€â–º[Chip1]â”€â”€â–º[Chip2]â”€â”€â–º[Chip3]â”€â”€â–º TDO
          â†‘         â†‘         â†‘
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€ TCK, TMS (shared)</div>

        <h3>Addressing Specific Chip</h3>
<pre><code>To access Chip2 only:
1. Put Chip1 in BYPASS (1-bit delay)
2. Put Chip2 in target mode (EXTEST, etc.)
3. Put Chip3 in BYPASS (1-bit delay)
4. Shift data: [Chip1 bypass][Chip2 data][Chip3 bypass]</code></pre>

        <h2>JTAG Use Cases</h2>

        <h3>1. Board-Level Testing</h3>
        <ul>
            <li>Test solder joints</li>
            <li>Find opens/shorts</li>
            <li>Verify connections</li>
        </ul>

        <h3>2. Chip Debugging</h3>
        <ul>
            <li>Access internal scan chains</li>
            <li>Read/write internal registers</li>
            <li>Control debug modes</li>
        </ul>

        <h3>3. Programming</h3>
        <ul>
            <li>Flash/FPGA programming</li>
            <li>Fuse programming</li>
            <li>Security features</li>
        </ul>

        <h3>4. In-System Test</h3>
        <ul>
            <li>Production testing</li>
            <li>Field diagnostics</li>
            <li>Firmware updates</li>
        </ul>

        <h2>JTAG Tools</h2>
        <table>
            <tr><th>Tool</th><th>Purpose</th></tr>
            <tr><td><strong>BSDL file</strong></td><td>Describes chip's JTAG interface</td></tr>
            <tr><td><strong>SVF file</strong></td><td>Portable test vectors</td></tr>
            <tr><td><strong>JTAG debugger</strong></td><td>Hardware interface (SEGGER, etc.)</td></tr>
            <tr><td><strong>OpenOCD</strong></td><td>Open-source JTAG software</td></tr>
        </table>

        <div class="summary">
            <h3>Summary</h3>
            <table>
                <tr><th>Concept</th><th>Key Point</th></tr>
                <tr><td>JTAG</td><td>5-wire standard test interface</td></tr>
                <tr><td>TAP</td><td>State machine controller</td></tr>
                <tr><td>TDI/TDO</td><td>Serial data path</td></tr>
                <tr><td>Boundary Scan</td><td>Test board connections</td></tr>
                <tr><td>Instructions</td><td>BYPASS, EXTEST, IDCODE, etc.</td></tr>
                <tr><td>Daisy chain</td><td>Multiple chips, one interface</td></tr>
            </table>
        </div>

        <div class="nav-buttons">
            <a href="09_BIST.html" class="nav-btn prev">BIST</a>
            <a href="11_Practical_DFT_Flow.html" class="nav-btn next">Practical DFT Flow</a>
        </div>
    </div>
    
    <div class="footer">
        <p>DFT Engineering Blog Series | Part 10 of 11</p>
    </div>
</body>
</html>
